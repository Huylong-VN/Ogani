@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = "~/Views/Shared/_layout_admin.cshtml";
}
<!-- Table -->
<!-- ============================================================== -->
<div class="row">
    <!-- column -->
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <!-- title -->
                <div class="d-md-flex">
                    <div>
                        <h4 class="card-title">Order Statistics</h4>
                        <h5 class="card-subtitle">Overview of Order Statistics</h5>
                    </div>
                    <div class="ms-auto">
                        <div class="dl">
                           <form class='form-group' onsubmit='return false'>
                               <input type='date' id='startDate' required class='form-control' placeholder='StartDate'/>
                               <input type='date' id='endDate' required class='form-control' placeholder='EndDate'/>
                               <button id='onStatic' class='btn btn-primary'>Submit</button>
                           </form>
                        </div>
                    </div>
                </div>
                <!-- title -->
            </div>
            <canvas id="myChart" width="400" height="100"></canvas>
        </div>
    </div>

    <!-- column -->
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <!-- title -->
                <div class="d-md-flex">
                    <div>
                        <h4 class="card-title">Revenue Statistics</h4>
                        <h5 class="card-subtitle">Overview of Revenue Statistics</h5>
                    </div>
                    <div class="ms-auto">
                        <div class="dl">
                          
                        </div>
                    </div>
                </div>
                <!-- title -->
            </div>
            <table>
            </table>
        </div>
    </div>
</div>
<!-- ============================================================== -->
<!-- Table -->
@section Scripts{
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.0/moment.min.js" integrity="sha512-Izh34nqeeR7/nwthfeE0SI3c8uhFSnqxV0sI9TvTcXiFJkMd6fB644O64BRq2P/LA/+7eRvCw4GmLsXksyTHBg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
   $("#onStatic").click((e) => {
     const startDate = $("#startDate").val()
     const endDate = $("#endDate").val()
     if (startDate && endDate) {
       if (document.getElementById('myChart')) {
              $('#myChart').replaceWith($('<canvas id="myChart" height="320px"></canvas>'));
         }
         getReport(startDate, endDate);
     }
 })

function getReport(startDate, endDate) {
	$.ajax({
		url: `/admin/getreport?startDate=${startDate}&endDate=${endDate}`,
		type: 'get',
		success: function (response) {
			console.log(response)
			RegisterChartProduct(response)
		}
	})
}
getReport(moment().subtract(30, "days").format('MM-DD-YYYY'), moment().format('MM-DD-YYYY'));

var lsLabel = [];
var LsDataSource = [];

function RegisterChartProduct(lsData) {
	lsLabel = [];
	LsDataSource = [];
	lsData.map((item) => {
		lsLabel.push(item.createAt);
		LsDataSource.push(item.total)
	})

	const ctx = document.getElementById('myChart');

      
	var barChartData = {
		labels: lsLabel,
		datasets: [{
			label: "Order statistics",
			backgroundColor: "#0b9663",
			borderWidth: 1,
			data: LsDataSource
		}]
	};
	var myBarChart = new Chart(ctx, {
		type: 'bar',
		data: barChartData
	})
}

</script>
}